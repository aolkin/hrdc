{% extends "venueapp/base.html" %}

{% load bt %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-md-8">
    <h3 class="text-center">Apply to put on a show!</h3>
    <p>
      <a href="{% url 'venueapp:new' %}">Create a new application</a>
    </p>
  </div>
</div>

{% if roles.exists %}
<h3 class="text-center">Your Application{{ roles.count|pluralize }}</h3>
<table class="table table-responsive bt-table-responsive table-striped">
  <thead>
    <tr>
      <th class="table-col-md">Show</th>
      <th class="table-col-sm table-col-desktop">Season</th>
      <th class="table-col-md">Role</th>
      <th class="text-center">Pre-app Submitted</th>
      <th class="text-center">Fully Submitted</th>
      <th class="text-right">Your Status</th>
    </tr>
  </thead>
  <tbody>
    {% for role in roles %}
    {% with show=role.show.show meta=role.show %}
    <tr>
      <td>{{ show.title }}</td>
      <td>{{ show.seasonstr }}</td>
      <td>{{ role.role }}</td>
      <td class="text-center">
	{% include "venueapp/pieces/checkmark.html" with value=meta.pre_submitted %}
	{% if meta.full_submitted %}{{ meta.pre_submitted }}{% endif %}
      </td>
      <td class="text-center">
	{% include "venueapp/pieces/checkmark.html" with value=meta.full_submitted %}
	{% if meta.full_submitted %}{{ meta.full_submitted }}{% endif %}
      </td>
      {% include "venueapp/pieces/staff_status.html" with table=0 role=role only %}
      <td class="text-right">
	{% if role.signed_on %}
	<span class="text-success">&lt;signed on&gt;</span>
	{% else %}
	<a href="{% url 'venueapp:join' meta.pk role.pk %}"
	   class="btn btn-success">Sign On</a>
	{% endif %}
      </td>
    </tr>
    {% endwith %}
    {% endfor %}
</table>
{{ form }}
{% endif %}

{% endblock %}
